# ğŸ¯ Project Conventions & Governance

**Last Updated:** 2025-11-26
**Status:** Living Document

---

## ğŸ“ File Organization

### Directory Structure

```
design-system-mcp/
â”œâ”€â”€ src/                        # Source code
â”‚   â”œâ”€â”€ services/              # Business logic
â”‚   â”œâ”€â”€ registry/              # Data loaders
â”‚   â”œâ”€â”€ tools/                 # MCP tools
â”‚   â”œâ”€â”€ types/                 # TypeScript types
â”‚   â””â”€â”€ index.ts               # Entry point
â”‚
â”œâ”€â”€ scripts/                    # Automation scripts
â”‚   â”œâ”€â”€ extraction/            # Data extraction
â”‚   â”œâ”€â”€ enrichment/            # Enrichment tools
â”‚   â””â”€â”€ utilities/             # Helper scripts
â”‚
â”œâ”€â”€ data/                       # Generated data (gitignored)
â”‚   â””â”€â”€ combined.json          # Primary dataset
â”‚
â”œâ”€â”€ docs/                       # Documentation
â”‚   â”œâ”€â”€ architecture/          # System design
â”‚   â”œâ”€â”€ guides/                # How-to guides
â”‚   â””â”€â”€ reference/             # API reference
â”‚
â”œâ”€â”€ archive/                    # Historical docs
â”‚   â”œâ”€â”€ analysis/
â”‚   â”œâ”€â”€ completion-reports/
â”‚   â””â”€â”€ presentations/
â”‚
â””â”€â”€ .claude/                    # Claude Code config
    â”œâ”€â”€ commands/              # Slash commands
    â””â”€â”€ agents/                # Agent definitions
```

### Rules

1. **No loose files in root** (except config files)
2. **Scripts must be in scripts/** subdirectories
3. **All docs in docs/ or archive/**
4. **Generated files in data/ (gitignored)**

---

## ğŸ“ Naming Conventions

### Files & Directories

| Type | Convention | Example |
|------|------------|---------|
| **Source code** | `kebab-case.ts` | `smart-enrichment-selector.ts` |
| **React/Vue components** | `PascalCase.tsx` | `EnrichmentEditor.tsx` |
| **Test files** | `*.test.ts` | `enrichment-filter.test.ts` |
| **Types** | `kebab-case.ts` | `enrichment-options.ts` |
| **Scripts** | `kebab-case.sh/js` | `normalize-doc-names.sh` |
| **Directories** | `kebab-case/` | `smart-enrichment/` |
| **Documentation** | `kebab-case.md` | `smart-filter-layer.md` |
| **Root docs** | `SCREAMING.md` | `README.md`, `CLAUDE.md` |

### Variables & Functions

| Type | Convention | Example |
|------|------------|---------|
| **Variables** | `camelCase` | `componentAdapter` |
| **Constants** | `SCREAMING_SNAKE_CASE` | `ENRICHMENT_PRESETS` |
| **Functions** | `camelCase` | `analyzeIntent()` |
| **Classes** | `PascalCase` | `EnrichmentFilter` |
| **Interfaces** | `PascalCase` | `EnrichmentOptions` |
| **Types** | `PascalCase` | `EnrichmentCategory` |
| **Enums** | `PascalCase` | `IntentType` |

---

## ğŸ¤– Agent Strategy

### When to Create an Agent

âœ… **Create agent when:**
- Task requires 3+ files to modify
- Complex multi-step workflow
- Domain-specific knowledge needed
- Reusable across multiple use cases

âŒ **Don't create agent when:**
- Simple one-file edit
- One-time task
- Generic coding task

### Agent Location

```
.claude/
â”œâ”€â”€ commands/
â”‚   â”œâ”€â”€ enrichment-maker.md        # Slash command definition
â”‚   â””â”€â”€ migrate-v1-v2.md
â”‚
â””â”€â”€ agents/                         # (future: if we add custom agents)
    â””â”€â”€ enrichment-specialist.md
```

### Agent Naming

- **Slash commands:** `kebab-case` (e.g., `/enrichment-maker`)
- **Agent files:** `kebab-case.md` (e.g., `enrichment-maker.md`)
- **Agent names in code:** `kebab-case` (e.g., `enrichment-maker`)

### Agent Documentation Required

Each agent must have:
1. **Purpose:** One-line description
2. **When to use:** Clear use cases
3. **Inputs:** Expected parameters
4. **Outputs:** What it produces
5. **Examples:** Real usage examples

---

## ğŸ“š Documentation Strategy

### Documentation Hierarchy

```
1. README.md              # Entry point (high-level)
2. CLAUDE.md              # AI assistant guide
3. docs/architecture/     # Deep dives
4. docs/guides/           # Step-by-step tutorials
5. docs/reference/        # API specs
```

### Document Types

| Type | Location | Naming | Purpose |
|------|----------|--------|---------|
| **Entry Point** | `README.md` | `README.md` | Project overview |
| **AI Guide** | `CLAUDE.md` | `CLAUDE.md` | Claude Code instructions |
| **Architecture** | `docs/architecture/` | `kebab-case.md` | System design |
| **Guides** | `docs/guides/` | `kebab-case.md` | How-to tutorials |
| **Reference** | `docs/reference/` | `kebab-case.md` | API documentation |
| **Historical** | `archive/` | `kebab-case.md` | Old docs |

### Documentation Rules

1. **Every feature needs docs**
   - Architecture doc (how it works)
   - Guide doc (how to use)
   - Reference doc (API)

2. **Update docs with code**
   - Don't commit code without updating docs
   - Keep CLAUDE.md in sync with features

3. **Archive old docs**
   - Don't delete historical docs
   - Move to `archive/` with timestamp

4. **Cross-reference liberally**
   - Link between related docs
   - Update all references when moving files

---

## ğŸ”§ README Files Strategy

### Where to Place README

**Rule:** Only `README.md` at root. Use index files for subdirectories.

| Location | Purpose | Filename |
|----------|---------|----------|
| Root | Project overview | `README.md` âœ… |
| docs/ | Documentation index | `index.md` or omit |
| archive/ | Archive guide | `index.md` or omit |
| scripts/ | Scripts overview | `index.md` or omit |
| src/services/ | Services guide | `index.md` or omit |

**Why?**
- Only one `README.md` (at root) avoids confusion
- GitHub shows README.md automatically
- Subdirectories can use `index.md` if needed
- Or just use descriptive filenames without index

### README Template

```markdown
# [Directory Name]

**Purpose:** One-line description

## Contents

- `file1.ts` - Description
- `file2.ts` - Description

## Usage

[Quick example]

## Related

- [Link to detailed docs]
```

---

## ğŸ¨ Code Organization

### Service Layer

```
src/services/
â”œâ”€â”€ README.md                       # Services overview
â”œâ”€â”€ component-adapter.ts            # Format conversion
â”œâ”€â”€ enrichment-filter.ts            # Filtering logic
â”œâ”€â”€ smart-enrichment-selector.ts    # Intent detection
â””â”€â”€ index.ts                        # Exports
```

**Rules:**
- One service per file
- Export from `index.ts`
- Include JSDoc comments
- Write unit tests

### Types Organization

```
src/types/
â”œâ”€â”€ index.ts                   # Main types (Component, Prop, Event)
â”œâ”€â”€ enrichment-options.ts      # Enrichment-specific types
â””â”€â”€ mcp-protocol.ts            # MCP protocol types (if needed)
```

**Rules:**
- Group related types
- Export from main `index.ts`
- Use TypeScript utility types
- Document complex types

---

## ğŸ§ª Testing Strategy

### Test File Location

```
src/services/
â”œâ”€â”€ enrichment-filter.ts
â””â”€â”€ __tests__/
    â””â”€â”€ enrichment-filter.test.ts
```

### Test Naming

- Test files: `[filename].test.ts`
- Describe blocks: Feature name
- Test cases: "should [behavior]"

### Coverage Requirements

| Type | Coverage |
|------|----------|
| Core services | 80%+ |
| Tools | 60%+ |
| Utilities | 70%+ |

---

## ğŸ“¦ Scripts Organization

### Script Categories

```
scripts/
â”œâ”€â”€ extraction/              # Data extraction
â”‚   â”œâ”€â”€ extract-components.ts
â”‚   â””â”€â”€ extract-usage.ts
â”‚
â”œâ”€â”€ enrichment/              # Enrichment tools
â”‚   â”œâ”€â”€ analyze-priorities.js
â”‚   â””â”€â”€ validate-enrichments.ts
â”‚
â”œâ”€â”€ docs/                    # Documentation tools
â”‚   â”œâ”€â”€ normalize-doc-names.sh
â”‚   â””â”€â”€ reorganize-docs.sh
â”‚
â””â”€â”€ utilities/               # Helper scripts
    â””â”€â”€ test-mcp-server.js
```

### Script Requirements

Each script must have:
1. **Shebang:** `#!/usr/bin/env node` or `#!/bin/bash`
2. **Description:** Comment at top
3. **Usage:** Help text (`--help`)
4. **Error handling:** Proper exit codes

---

## ğŸ”„ Git Workflow

### Branch Naming

| Type | Format | Example |
|------|--------|---------|
| Feature | `feat/[name]` | `feat/smart-filter-layer` |
| Bugfix | `fix/[name]` | `fix/token-calculation` |
| Docs | `docs/[name]` | `docs/update-readme` |
| Refactor | `refactor/[name]` | `refactor/adapter-logic` |

### Commit Messages

Follow Conventional Commits:

```
<type>(<scope>): <description>

[optional body]

[optional footer]
```

**Types:**
- `feat:` New feature
- `fix:` Bug fix
- `docs:` Documentation
- `refactor:` Code refactor
- `test:` Tests
- `chore:` Maintenance

**Example:**
```
feat(filter): add Smart Filter Layer for token optimization

- Add ComponentAdapter for format conversion
- Add SmartEnrichmentSelector for intent detection
- Add EnrichmentFilter for in-memory filtering

Closes #123
```

---

## ğŸš¨ Pre-commit Checks

### Required Checks

1. âœ… TypeScript compiles (`npm run build`)
2. âœ… Tests pass (`npm test`)
3. âœ… Linter passes (`npm run lint`)
4. âœ… Naming conventions followed
5. âœ… Documentation updated

### Automation

```bash
# .husky/pre-commit
npm run build
npm run lint
npm test
```

---

## ğŸ¯ Decision Log

### When to Document Decisions

Document when:
- Architecture changes
- Breaking changes
- New conventions added
- Technology choices

### Decision Log Format

```markdown
# Decision: [Title]

**Date:** YYYY-MM-DD
**Status:** Accepted/Rejected/Superseded
**Context:** Why we needed to decide
**Decision:** What we decided
**Consequences:** Pros/cons
```

**Location:** `docs/decisions/YYYYMMDD-decision-title.md`

---

## ğŸ” Code Review Checklist

### Reviewer Checklist

- [ ] Code follows naming conventions
- [ ] Tests included and passing
- [ ] Documentation updated
- [ ] No hardcoded values
- [ ] Error handling present
- [ ] Type safety maintained
- [ ] Performance considered
- [ ] Security reviewed

---

## ğŸ“Š Metrics & Monitoring

### Track These Metrics

1. **Code Quality**
   - Test coverage %
   - TypeScript strict mode compliance
   - Linting errors

2. **Documentation Quality**
   - % of features documented
   - Doc update lag (days)
   - Broken links

3. **Repository Health**
   - Files in root (max 10)
   - Avg file size
   - Directory depth

---

## ğŸ› ï¸ Tooling

### Required Tools

```json
{
  "typescript": "^5.0.0",
  "eslint": "^8.0.0",
  "prettier": "^3.0.0",
  "vitest": "^1.0.0",
  "husky": "^8.0.0"
}
```

### Configuration Files

- `.eslintrc.json` - Linting rules
- `.prettierrc` - Formatting rules
- `tsconfig.json` - TypeScript config
- `.gitignore` - Git ignore patterns

---

## ğŸ“ Maintenance Schedule

### Weekly
- Review open issues
- Update documentation
- Check test coverage

### Monthly
- Review naming conventions
- Archive old docs
- Update dependencies

### Quarterly
- Major refactoring if needed
- Architecture review
- Convention updates

---

## ğŸ†˜ Enforcement

### Automated
- Pre-commit hooks
- CI/CD checks
- Linting rules

### Manual
- Code reviews
- Documentation reviews
- Periodic audits

---

**This is a living document. Update as project evolves.**

**Questions?** Open an issue or update this doc.
